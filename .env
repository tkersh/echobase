# Echobase Environment Configuration
# This file is tracked in git and contains non-secret configuration.
# Secrets (JWT_SECRET, MCP_API_KEY) are in .env.secrets (generated, gitignored).
# Run ./scripts/generate-credentials.sh to create .env.secrets

# Database Configuration
# Database credentials are managed by durable/setup.sh and stored in Secrets Manager
# Applications retrieve credentials from Secrets Manager at runtime
# These environment variables are only used as fallback/reference
DB_HOST=echobase-devlocal-durable-mariadb
DB_PORT=3306
DB_NAME=orders_db

# Secrets Manager Configuration
# Database credentials are stored in AWS Secrets Manager (Localstack)
DB_SECRET_NAME=echobase/database/credentials

# AWS/Localstack Configuration
# NOTE: For local development with Localstack, use 'test' credentials
# For production AWS, use IAM roles or AWS Secrets Manager instead
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=test
AWS_SECRET_ACCESS_KEY=test

# SQS Configuration (ephemeral LocalStack for queues)
# Use full container name to avoid DNS conflict with durable LocalStack
SQS_ENDPOINT=http://echobase-devlocal-localstack:4566
SQS_QUEUE_URL=http://sqs.us-east-1.localhost.localstack.cloud:4566/000000000000/order-processing-queue

# Secrets Manager Configuration (durable LocalStack for credentials)
# Points to durable LocalStack container for persistent secrets
SECRETS_MANAGER_ENDPOINT=http://echobase-devlocal-durable-localstack:4566

# API Gateway Configuration
PORT=3001                                    # Port for API Gateway (HTTPS)
CORS_ORIGIN=https://localhost:3443           # Comma-separated list of allowed origins for CORS
RATE_LIMIT_WINDOW_MS=900000                  # Rate limit time window in milliseconds (default: 15 minutes)
RATE_LIMIT_MAX_REQUESTS=100000               # Maximum requests per IP within window (default: 100000 for dev)
CSRF_PROTECTION=true                         # Enable CSRF protection (set to 'false' only for testing)

# Logging Configuration
LOG_LEVEL=INFO                               # Log level: DEBUG, INFO, WARN, ERROR, FATAL (default: INFO)
LOG_FORMAT=text                              # Log format: 'text' or 'json' (default: text)
LOG_COLORS=true                              # Enable colored log output (set to 'false' for production)

# Feature Flags
OTEL_ENABLED=true                            # Set 'false' to disable all OTEL instrumentation
RATE_LIMIT_ENABLED=true                      # Set 'false' to disable rate limiting (not recommended)
NODE_ENV=development                         # 'production' disables Swagger UI and enables strict SSL

# Order Processor Configuration
MAX_MESSAGES=10                              # Maximum messages to retrieve from SQS per long-poll (default: 10)
HEALTH_PORT=3003                             # HTTP health endpoint port for order processor
DB_CONNECTION_LIMIT=2                        # Max concurrent DB connections for order processor

# Frontend Configuration
# Leave empty to use same-origin (nginx proxies /api/* to backend)
# This works for all environments (devlocal, ci-blue, green)
VITE_API_URL=                                # API URL (empty = same-origin via nginx proxy)
VITE_LOG_LEVEL=INFO                          # Frontend log level: DEBUG, INFO, WARN, ERROR (default: INFO)

# MCP Server Configuration
MCP_SERVER_ENDPOINT=http://echobase-devlocal-durable-mcp-server:3002
# MCP_API_KEY is in .env.secrets

# OpenTelemetry Configuration
OTEL_COLLECTOR_ENDPOINT=http://echobase-devlocal-durable-otel-collector:4318
OTEL_TRACE_SAMPLE_RATIO=0.25
