# Echobase Environment Configuration Example
# Copy this file to .env and run ./scripts/generate-credentials.sh to generate secure credentials
# Or manually set your own values

# Database Configuration
# Database credentials are managed by durable/setup.sh and stored in Secrets Manager
# Applications retrieve credentials from Secrets Manager at runtime
# These environment variables are only used as fallback/reference
DB_HOST=echobase-devlocal-durable-mariadb
DB_PORT=3306
DB_NAME=orders_db

# Secrets Manager Configuration
# Database credentials are stored in AWS Secrets Manager (Localstack)
DB_SECRET_NAME=echobase/database/credentials

# AWS/Localstack Configuration
# NOTE: For local development with Localstack, use 'test' credentials
# For production AWS, use IAM roles or AWS Secrets Manager instead
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=test
AWS_SECRET_ACCESS_KEY=test

# SQS Configuration (ephemeral LocalStack for queues)
# Use full container name to avoid DNS conflict with durable LocalStack
SQS_ENDPOINT=http://echobase-devlocal-localstack:4566
SQS_QUEUE_URL=http://sqs.us-east-1.localhost.localstack.cloud:4566/000000000000/order-processing-queue

# Secrets Manager Configuration (durable LocalStack for credentials)
# Points to durable LocalStack container for persistent secrets
SECRETS_MANAGER_ENDPOINT=http://echobase-devlocal-durable-localstack:4566

# API Gateway Configuration
PORT=3001                                    # Port for API Gateway (HTTPS)
CORS_ORIGIN=https://localhost:3443           # Comma-separated list of allowed origins for CORS
RATE_LIMIT_WINDOW_MS=900000                  # Rate limit time window in milliseconds (default: 15 minutes)
RATE_LIMIT_MAX_REQUESTS=100000               # Maximum requests per IP within window (default: 100000 for dev)
CSRF_PROTECTION=true                         # Enable CSRF protection (set to 'false' only for testing)

# Logging Configuration
LOG_LEVEL=INFO                               # Log level: DEBUG, INFO, WARN, ERROR, FATAL (default: INFO)
LOG_COLORS=true                              # Enable colored log output (set to 'false' for production)

# Order Processor Configuration
POLL_INTERVAL=5000                           # SQS polling interval in milliseconds (default: 5 seconds)
MAX_MESSAGES=10                              # Maximum messages to retrieve from SQS per poll (default: 10)

# Frontend Configuration
# Leave empty to use same-origin (nginx proxies /api/* to backend)
# This works for all environments (devlocal, ci-blue, green)
REACT_APP_API_URL=                           # API URL (empty = same-origin via nginx proxy)
VITE_LOG_LEVEL=INFO                          # Frontend log level: DEBUG, INFO, WARN, ERROR (default: INFO)

# Security Configuration
# JWT secret for token signing/verification
# Generate with: openssl rand -base64 64
JWT_SECRET=CHANGE_ME_TO_STRONG_RANDOM_SECRET # CRITICAL: Change to secure random value

# IMPORTANT SECURITY NOTES:
# 1. NEVER commit the .env file to version control
# 2. Run ./scripts/generate-credentials.sh to automatically generate:
#    - Secure credentials for all services
#    - Database encryption keys (mariadb/config/keyfile.enc)
#    - JWT secrets
# 3. Database encryption at rest is ENABLED by default
# 4. Backup both .env AND mariadb/config/keyfile.enc securely
# 5. For production:
#    - Use AWS Secrets Manager or similar for credential management
#    - Use IAM roles instead of hardcoded AWS credentials
#    - Use separate encryption keys for each environment
#    - Implement proper authentication and authorization